/*
  styles.improved.css
  - Consolidated variables and duplicated blocks
  - Improved responsiveness (auto-fit / minmax grids)
  - Added accessible focus states and keyboard-friendly styles
  - Cross-browser scrollbar tweaks (WebKit + Firefox)
  - Reduced-motion support
  - Performance improvements (prefer transform/opacity for animations, will-change hints)
  - Comments grouped by sections for easier maintenance
*/

/* -----------------------------
   Root variables & theme
   ----------------------------- */
:root{
  /* palette */
  --page-bg: #f3f6f9;
  --panel-bg: #ffffff;
  --sidebar-bg: #0f172a;
  --sidebar-compact-bg: #0b1220;
  --topbar-bg: #ffffff;
  --text-main: #0f172a;
  --muted: #94a3b8;
  --accent: #10b981; /* green */
  --warn: #f59e0b;
  --danger: #ef4444;
  --card-border: #e6eef4;
  --sidebar-border: #111827;
  --glass: rgba(255,255,255,0.02);

  /* sizing & spacing */
  --sidebar-width: 280px;
  --sidebar-collapsed-width: 72px;
  --content-gap: 16px;
  --page-padding: 24px;
  --radius: 10px;
  --card-radius: 8px;
  --grid-gap: 16px;
  --card-min-width: 240px; /* used with auto-fit */

  /* typography */
  --font-stack: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  --type-large: 28px;
  --type-small: 12px;

  /* motion */
  --transition: 180ms ease;
  --transition-long: 400ms ease;

  /* elevation */
  --shadow-soft: 0 6px 14px rgba(12,24,44,0.02);
}

/* -----------------------------
   Reset / base
   ----------------------------- */
*,:where(*::before, *::after){ box-sizing: border-box; }
html,body,#root{ height:100%; margin:0; background:var(--page-bg); font-family:var(--font-stack); color:var(--text-main); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
img{ max-width:100%; height:auto; display:block; }
button{ font: inherit; }

/* visually hidden utility */
.visually-hidden{ position:absolute !important; height:1px; width:1px; overflow:hidden; clip:rect(1px,1px,1px,1px); white-space:nowrap; }

/* prefer reduced motion */
@media (prefers-reduced-motion: reduce){
  :root{ --transition: 0ms; --transition-long: 0ms; }
  * { animation-duration: 0ms !important; transition-duration: 0ms !important; }
}

/* -----------------------------
   App layout
   ----------------------------- */
.app-root{ display:flex; min-height:100vh; height:100vh; overflow:hidden; }

/* main area -- column layout */
.main-area{ flex:1; display:flex; flex-direction:column;min-height: 0; min-width:0; height:100%; }

/* sensible topbar defaults; unified definition */
.topbar{ height:64px; display:flex; align-items:center; justify-content:space-between; padding-inline:18px; border-bottom:1px solid var(--card-border); background:var(--topbar-bg); box-shadow: 0 1px 0 rgba(16,24,40,0.02); }
.topbar .left, .topbar .right{ display:flex; align-items:center; gap:12px; }

/* content area */
.content-area{ flex:1; overflow-y:auto; display:flex; flex-direction:column; padding:block var(--page-padding); padding-inline:var(--page-padding); gap:var(--content-gap); background:var(--page-bg); min-height: 0;}

/* -----------------------------
   Sidebar (single consolidated block)
   - keeps its own scrolling area
   - supports collapsed state
   ----------------------------- */
.sidebar{
  width:var(--sidebar-width);
  min-width:var(--sidebar-collapsed-width);
  background:var(--sidebar-bg);
  color:#cbd5e1;
  display:flex;
  flex-direction:column;
  border-right:1px solid var(--sidebar-border);
  height:100vh; /* keeps its own scroll region */
  transition: width var(--transition);
  box-sizing:border-box;
}
.sidebar.collapsed{ width:var(--sidebar-collapsed-width); }

/* brand */
.sidebar .brand{ padding:12px; display:flex; align-items:center; gap:12px; position:relative; border-bottom:1px solid #142233; }
.brand .logo, .logo-img, .logo-fallback{ width:48px; height:48px; border-radius:8px; display:grid; place-items:center; }
.brand-text{ display:flex; flex-direction:column; }
.brand-text .title{ font-weight:700; color:#e6eef4; }
.brand-text .subtitle{ font-size:var(--type-small); color:var(--muted); }
.sidebar.collapsed .brand-text{ display:none; }

/* collapse button */
.collapse-btn{ position:absolute; right:8px; top:8px; background:transparent; border:0; color:#9ca3af; cursor:pointer; padding:6px; border-radius:6px; }
.collapse-btn:hover{ background: rgba(255,255,255,0.03); }

/* nav area and scrollbar (WebKit + Firefox-friendly) */
.sidebar nav{ flex:1; overflow-y:auto; padding:8px 0; }
.sidebar nav::-webkit-scrollbar{ width:10px; }
.sidebar nav::-webkit-scrollbar-thumb{ background:var(--sidebar-compact-bg); border-radius:6px; border:2px solid var(--sidebar-bg); }
.sidebar nav::-webkit-scrollbar-track{ background:transparent; }
/* Firefox */
.sidebar nav{ scrollbar-width: thin; scrollbar-color: var(--sidebar-compact-bg) transparent; }

/* nav items - keyboard and aria-friendly */
.nav-item{ display:flex; align-items:center; gap:12px; padding:10px 14px; cursor:pointer; color:#cbd5e1; border-left:4px solid transparent; transition: background var(--transition), color var(--transition), padding var(--transition); }
.nav-item .icon{ width:28px; display:flex; align-items:center; justify-content:center; color:#9fb2c6; }
.nav-item .label{ font-weight:600; color:#e6eef4; }
.nav-item:hover, .nav-item:focus-visible{ background:#0b1220; color:#ffffff; }
.nav-item.active, .nav-item[aria-current="page"]{ background: linear-gradient(90deg,#0b1220,#12202b); color:#fff; border-left:4px solid var(--accent); padding-left:10px; }
.sidebar.collapsed .nav-item .label{ display:none; }
.sidebar.collapsed .nav-item.active{ border-left:none; background: rgba(255,255,255,0.02); }

/* focus-visible fallback for browsers lacking support */
:focus{ outline: none; }
:focus-visible{ outline: 3px solid rgba(16,185,129,0.18); outline-offset:2px; }

/* bottom status area */
.sidebar .status{ padding:12px 16px; border-top:1px solid #142233; font-size:13px; background: linear-gradient(180deg,var(--glass), transparent); }
.sidebar.collapsed .status{ display:none; }
/* -----------------------------
   Cards, grid and components
   ----------------------------- */
.cards-grid{ display:grid; grid-template-columns: repeat(auto-fit, minmax(var(--card-min-width), 1fr)); gap:var(--grid-gap); margin-top:16px; }
.card{ background:var(--panel-bg); border-radius:var(--radius); padding:16px; border:1px solid var(--card-border); box-shadow: var(--shadow-soft); }
.card.large{ grid-column: span 2; display:flex; align-items:center; justify-content:space-between; }
.metric{ font-size:var(--type-large); font-weight:700; color:var(--text-main); }
.metric-sub{ font-size:12px; color:var(--muted); }

.banner{ background: linear-gradient(90deg,#ecfeff,#f0fdf4); border-radius:var(--radius); padding:16px; display:flex; justify-content:space-between; align-items:center; border:1px solid #e6f6ef; margin-bottom:18px; }

/* gallery */
.gallery{ display:grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap:12px; }
.thumb{ width:100%; aspect-ratio: 4/3; border-radius:8px; background: linear-gradient(180deg,#e6eef4,#f3f8fb); display:flex; align-items:center; justify-content:center; }

/* alerts */
.alert-list{ display:flex; flex-direction:column; gap:10px; }
.alert-item{ display:flex; justify-content:space-between; gap:12px; align-items:center; padding:12px; border-radius:8px; background:#fff; border:1px solid var(--card-border); }

/* helper classes */
.kv{ font-size:12px; color:var(--muted); }
.badge{ background:#eefcf3; color:#065f46; padding:6px 10px; border-radius:999px; font-weight:600; font-size:12px; }

.status-dot{ width:12px; height:12px; border-radius:50%; display:inline-block; margin-right:8px; vertical-align:middle; box-shadow: 0 1px 0 rgba(0,0,0,0.04); }

/* compass */
.compass{ display:flex; flex-direction:column; align-items:center; gap:8px; }
.compass .compass-svg{ width:72px; height:72px; display:block; }
.compass .dir-label{ font-size:12px; color:var(--muted); }

.compass-box{ position:relative; width:96px; height:96px; border-radius:50%; border:4px solid #bfdbfe; background:#ffffff; box-shadow: inset 0 2px 6px rgba(0,0,0,0.05); margin:auto; }
.compass-box .label{ position:absolute; font-size:11px; font-weight:700; color:#1e40af; }
.compass-box .center-dot{ position:absolute; top:50%; left:50%; width:8px; height:8px; background:#2563eb; border-radius:9999px; transform:translate(-50%,-50%); z-index:10; }
.compass-box .needle{ position:absolute; top:50%; left:50%; width:2px; height:48px; background:#ef4444; transform-origin: bottom; transform: translate(-50%, -100%) rotate(0deg); transition: transform var(--transition-long) cubic-bezier(.2,.8,.2,1); will-change: transform; }
.compass-box .needle::after{ content:""; position:absolute; top:-8px; left:-4px; border-left:4px solid transparent; border-right:4px solid transparent; border-bottom:8px solid #ef4444; }

/* value bar */
.value-bar{ position:relative; height:8px; border-radius:999px; background:#e2e8f0; margin-top:8px; overflow:hidden; }
.value-bar .indicator{ position:absolute; top:0; left:0; height:100%; background:var(--accent); border-radius:999px; transition: width 0.4s ease; }

/* card status backgrounds */
.card.status-good{ background:#ecfdf5; border:1px solid #d1fae5; }
.card.status-warning{ background:#fffbeb; border:1px solid #fde68a; }
.card.status-alert{ background:#fef2f2; border:1px solid #fecaca; }

/* footer stats */
.stats-row{ display:flex; justify-content:space-between; font-size:11px; color:var(--muted); margin-top:6px; }

/* direction card explicit style */
.card.direction-card{ background:var(--panel-bg); border:1px solid var(--card-border); }

/* maps */


/* -----------------------------
   Responsive tweaks
   ----------------------------- */
@media (max-width:1100px){
  .sidebar{ width:220px; }
  .cards-grid{ grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
}
@media (max-width:640px){
  .sidebar{ display:none; }
  .cards-grid{ grid-template-columns: 1fr; }
}

/* -----------------------------
   Accessibility / utilities
   ----------------------------- */
/* recommended: ensure interactive elements show a clear focus ring */
button:focus-visible, .nav-item:focus-visible, .collapse-btn:focus-visible{ outline: 3px solid rgba(16,185,129,0.18); outline-offset:2px; }

/* small visual helpers */
.center{ display:grid; place-items:center; }


   /* Layout for map + legend side-by-side (responsive) */
.map-layout {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 16px;
  align-items: start;
}

/* collapse to single column on smaller screens */
@media (max-width: 900px) {
  .map-layout { grid-template-columns: 1fr; }
}

/* map card: remove top/bottom padding around map-box so the map fills the card content area */
.card.map-card {
  padding: 0;                /* header is internal */
  display: flex;
  flex-direction: column;
  min-height: 0;
}

/* make header look consistent if you use the inline header in the component */
.card.map-card .card-header { height: 54px; }

/* core map surface: give it a controlled height (not full page) */
.map-card .map-box {
  width: 100%;
  height: 420px;      /* adjust to taste (400-480 typical) */
  min-height: 280px;
  border-bottom-left-radius: 10px;
  border-bottom-right-radius: 10px;
}

/* legend */
.legend-card { display:flex; flex-direction:column; gap:8px; }
.legend-dot {
  width: 14px;
  height: 14px;
  border-radius: 9999px;
  display:inline-block;
  box-shadow: 0 1px 0 rgba(0,0,0,0.06);
  border: 2px solid rgba(255,255,255,0.6);
}
.legend-item.inactive { opacity: 0.45; transform: scale(0.995); }
.legend-item:hover { transform: translateY(-2px); transition: transform 140ms ease; }

/* small helper to ensure cards-grid doesn't force full-screen behaviour for the map card */
.cards-grid .map-card { grid-column: span 2; } /* if you put map inside cards-grid and want it wider */

/* user menu items for topbar */
.topbar .user-btn { transition: background 160ms ease; }
.topbar .user-btn:focus-visible { outline: 3px solid rgba(16,185,129,0.12); outline-offset: 2px; }
.user-menu { transition: opacity 160ms ease, transform 160ms ease; }
.user-menu .menu-item:hover { background: rgba(15,23,42,0.03); }
.user-menu .logout { color: var(--danger); }
@media (max-width: 640px) {
  /* hide the name and account type on very small widths to save space */
  .topbar .user-btn > div { display: none; }
}
